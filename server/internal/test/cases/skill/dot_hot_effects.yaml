# 技能系统 - DOT/HOT效果测试
test_suite: "技能系统 - DOT/HOT效果"
description: "测试持续伤害（DOT）和持续治疗（HOT）效果，包括间隔触发、持续时间、叠加等"

tests:
  - name: "DOT效果基础测试"
    description: "测试持续伤害效果的基本功能"
    category: "integration"
    priority: "high"
    setup:
      - "创建一个角色，攻击力=20"
      - "创建一个怪物，HP=100，防御力=10"
      - "给怪物添加持续3回合，每回合10点伤害的DOT"
    steps:
      - action: "执行第1回合"
        expected: "DOT效果触发，怪物HP减少10点"
      - action: "执行第2回合"
        expected: "DOT效果触发，怪物HP再次减少10点"
      - action: "执行第3回合"
        expected: "DOT效果触发，怪物HP再次减少10点，DOT效果结束"
    assertions:
      - type: "equals"
        target: "monster.hp_round_1"
        expected: "90"
        message: "第1回合后怪物HP应该为90"
      - type: "equals"
        target: "monster.hp_round_3"
        expected: "70"
        message: "第3回合后怪物HP应该为70"

  - name: "HOT效果基础测试"
    description: "测试持续治疗效果的基本功能"
    category: "integration"
    priority: "high"
    setup:
      - "创建一个角色，HP=50/100"
      - "给角色添加持续4回合，每回合15点治疗的HOT"
    steps:
      - action: "执行第1回合"
        expected: "HOT效果触发，角色HP增加15点，HP=65"
      - action: "执行第2回合"
        expected: "HOT效果触发，角色HP增加15点，HP=80"
      - action: "执行第3回合"
        expected: "HOT效果触发，角色HP增加15点，HP=95"
      - action: "执行第4回合"
        expected: "HOT效果触发，角色HP增加15点，HP=100（满血），HOT效果结束"
    assertions:
      - type: "equals"
        target: "character.hp_round_1"
        expected: "65"
        message: "第1回合后角色HP应该为65"
      - type: "equals"
        target: "character.hp_round_4"
        expected: "100"
        message: "第4回合后角色HP应该为100（满血，不会超过最大HP）"

  - name: "DOT持续触发测试"
    description: "测试DOT效果每回合持续触发"
    category: "integration"
    priority: "medium"
    setup:
      - "创建一个怪物，HP=100"
      - "给怪物添加持续6回合，每回合20点伤害的DOT"
    steps:
      - action: "执行第1回合"
        expected: "DOT效果触发，怪物HP减少20点"
      - action: "执行第2回合"
        expected: "DOT效果触发，怪物HP再次减少20点"
      - action: "执行第3回合"
        expected: "DOT效果触发，怪物HP再次减少20点"
      - action: "执行第4回合"
        expected: "DOT效果触发，怪物HP再次减少20点"
    assertions:
      - type: "equals"
        target: "monster.hp_round_1"
        expected: "80"
        message: "第1回合后HP应该减少20点"
      - type: "equals"
        target: "monster.hp_round_2"
        expected: "60"
        message: "第2回合后HP应该再次减少20点"
      - type: "equals"
        target: "monster.hp_round_4"
        expected: "20"
        message: "第4回合后HP应该再次减少20点（100-20*4=20）"

  - name: "HOT效果持续测试"
    description: "测试HOT效果持续多个回合"
    category: "integration"
    priority: "high"
    setup:
      - "创建一个角色，HP=50/100"
      - "给角色添加持续3回合，每回合15点治疗的HOT"
    steps:
      - action: "执行第1回合"
        expected: "HOT恢复15点HP，HP=65"
      - action: "执行第2回合"
        expected: "HOT恢复15点HP，HP=80"
      - action: "执行第3回合"
        expected: "HOT恢复15点HP，HP=95，HOT效果结束"
    assertions:
      - type: "equals"
        target: "character.hp_round_1"
        expected: "65"
        message: "第1回合后HP应该为65（50+15）"
      - type: "equals"
        target: "character.hp_round_3"
        expected: "95"
        message: "第3回合后HP应该为95（50+15*3）"

  - name: "敌人DOT效果测试"
    description: "测试对敌人施加的DOT效果"
    category: "integration"
    priority: "high"
    setup:
      - "创建一个角色，攻击力=20"
      - "创建一个怪物，HP=100，防御力=10"
      - "给怪物添加持续4回合，每回合12点伤害的DOT"
    steps:
      - action: "执行第1回合"
        expected: "怪物受到12点伤害"
      - action: "执行第2回合"
        expected: "怪物再次受到12点伤害"
      - action: "执行第3回合"
        expected: "怪物再次受到12点伤害"
      - action: "执行第4回合"
        expected: "怪物再次受到12点伤害，DOT效果结束"
    assertions:
      - type: "equals"
        target: "monster.hp_round_1"
        expected: "88"
        message: "第1回合后怪物HP应该为88（100-12）"
      - type: "equals"
        target: "monster.hp_round_4"
        expected: "52"
        message: "第4回合后怪物HP应该为52（100-12*4）"

  - name: "DOT效果持续时间测试"
    description: "测试DOT效果的持续时间"
    category: "integration"
    priority: "medium"
    setup:
      - "创建一个怪物，HP=100"
      - "给怪物添加持续3回合，每回合10点伤害的DOT"
    steps:
      - action: "执行第1回合"
        expected: "DOT效果触发，怪物HP减少10点"
      - action: "执行第2回合"
        expected: "DOT效果触发，怪物HP再次减少10点"
      - action: "执行第3回合"
        expected: "DOT效果触发，怪物HP再次减少10点，DOT效果结束"
      - action: "执行第4回合"
        expected: "DOT效果已结束，不再造成伤害"
    assertions:
      - type: "equals"
        target: "monster.hp_round_1"
        expected: "90"
        message: "第1回合后HP应该为90"
      - type: "equals"
        target: "monster.hp_round_3"
        expected: "70"
        message: "第3回合后HP应该为70"
      - type: "equals"
        target: "monster.hp_round_4"
        expected: "70"
        message: "第4回合后HP应该仍为70（DOT已结束）"

