# 经济系统设计文档

> 📌 **核心设计理念**: 建立金币和装备的有效消耗途径，形成经济闭环，驱动玩家持续挑战

---

## 📋 目录

1. [系统概览](#系统概览)
2. [金币获取](#金币获取)
3. [金币消耗](#金币消耗)
4. [装备强化消耗](#装备强化消耗)
5. [商店系统](#商店系统)
6. [经济平衡设计](#经济平衡设计)

---

## 系统概览

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          经济系统架构                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   金币获取 ──→ 金币存储 ──→ 金币消耗 ──→ 装备强化 ──→ 提升战力              │
│      │            │            │            │            │                 │
│   战斗获得    玩家账户    购买材料    强化装备    继续挑战                 │
│   任务奖励    交易获得    强化消耗    提升属性    获得更多                 │
│                                                                             │
│   经济闭环:                                                                  │
│   刷怪 → 获得金币和装备 → 强化装备 → 提升战力 → 挑战更强怪物 → 获得更多    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 金币获取

### 获取途径

#### 1. 战斗获得

```
基础金币 = 怪物基础金币 × 区域倍率 × 难度倍率

怪物基础金币:
├─ 普通怪物: 1-5金币
├─ 精英怪物: 5-15金币
├─ Boss: 20-50金币
└─ 特殊怪物: 10-30金币

区域倍率:
├─ 低级区域: 1.0
├─ 中级区域: 1.2
├─ 高级区域: 1.5
└─ 顶级区域: 2.0
```

#### 2. 任务奖励

```
任务金币 = 任务基础金币 × 任务难度倍率

任务类型:
├─ 日常任务: 10-50金币
├─ 周常任务: 50-200金币
└─ 主线任务: 100-500金币
```

#### 3. 装备出售

```
出售价格 = 装备基础价格 × 品质倍率 × 等级倍率

品质倍率:
├─ 白色: 1.0
├─ 绿色: 1.5
├─ 蓝色: 2.0
├─ 紫色: 3.0
├─ 橙色: 5.0
└─ 独特: 10.0
```

#### 4. 交易获得

```
交易金币 = 装备售价 - 交易手续费

交易手续费: 5-10%
```

---

## 金币消耗

### 消耗途径

#### 1. 装备强化

```
强化消耗 = 基础消耗 × 强化等级 × 装备品质倍率

基础消耗:
├─ 1级强化: 100金币
├─ 2级强化: 200金币
├─ 3级强化: 400金币
├─ 4级强化: 800金币
└─ 5级强化: 1600金币

品质倍率:
├─ 蓝色: 1.0
├─ 紫色: 1.5
├─ 橙色: 2.0
└─ 独特: 3.0
```

#### 2. 材料购买

```
材料价格 = 基础价格 × 材料稀有度倍率

材料类型:
├─ 基础材料: 10-50金币
├─ 精华材料: 50-200金币
├─ 催化剂: 100-500金币
└─ 保护材料: 200-1000金币
```

#### 3. 技能学习

```
技能学习费用 = 基础费用 × 技能等级

基础费用:
├─ 1级技能: 100金币
├─ 2级技能: 200金币
├─ 3级技能: 400金币
├─ 4级技能: 800金币
└─ 5级技能: 1600金币
```

#### 4. 属性重置

```
重置费用 = 基础费用 × 角色等级

基础费用: 1000金币
```

#### 5. 商店购买

```
商店物品价格 = 基础价格 × 物品稀有度倍率
```

---

## 装备强化消耗

### 强化材料

#### 1. 基础材料

**用途**: 重铸词缀、添加词缀

**获取**:
- 战斗掉落
- 商店购买
- 装备分解

**消耗**:
```
重铸词缀: 基础材料 × 3
添加词缀: 基础材料 × 5
```

#### 2. 精华材料

**用途**: 保证特定词缀

**获取**:
- 精英怪物掉落
- 商店购买
- 任务奖励

**消耗**:
```
保证词缀: 精华材料 × 1
```

#### 3. 催化剂

**用途**: 强化已有词缀数值

**获取**:
- Boss掉落
- 商店购买
- 任务奖励

**消耗**:
```
强化词缀: 催化剂 × 1 + 金币 × 强化等级
```

#### 4. 保护材料

**用途**: 锁定词缀不被改变

**获取**:
- 特殊怪物掉落
- 商店购买
- 任务奖励

**消耗**:
```
锁定词缀: 保护材料 × 1
```

### 强化消耗计算

```
总消耗 = 材料消耗 + 金币消耗

材料消耗 = Σ(材料数量 × 材料价格)
金币消耗 = 基础金币 × 强化等级 × 品质倍率
```

---

## 商店系统

### 商店类型

#### 1. NPC商店

**功能**:
- 出售基础材料
- 出售消耗品
- 回收装备

**商品类型**:
- 基础材料
- 消耗品（药水、食物）
- 基础装备（白色/绿色）

#### 2. 拍卖行

**功能**:
- 玩家间交易
- 装备流通
- 价格发现

**交易规则**:
- 上架费用: 装备价格的5%
- 交易手续费: 成交价格的10%
- 上架时间: 24-72小时

#### 3. 特殊商店

**功能**:
- 出售稀有材料
- 出售独特装备
- 限时商品

**商品类型**:
- 精华材料
- 催化剂
- 保护材料
- 独特装备

### 商店配置

```sql
-- 商店配置表
CREATE TABLE shops (
    id VARCHAR(32) PRIMARY KEY,
    name VARCHAR(64) NOT NULL,
    type VARCHAR(32) NOT NULL,  -- npc/auction/special
    description TEXT
);

-- 商店商品表
CREATE TABLE shop_items (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    shop_id VARCHAR(32) NOT NULL,
    item_id VARCHAR(32) NOT NULL,
    price INTEGER NOT NULL,
    stock INTEGER DEFAULT -1,  -- -1表示无限
    refresh_interval INTEGER,  -- 刷新间隔（小时）
    FOREIGN KEY (shop_id) REFERENCES shops(id),
    FOREIGN KEY (item_id) REFERENCES items(id)
);
```

---

## 经济平衡设计

### 平衡原则

#### 1. 获取与消耗平衡

```
平均每小时获取金币 ≈ 平均每小时消耗金币 × 1.2

说明: 获取略高于消耗，让玩家有积累感
```

#### 2. 强化成本递增

```
强化成本 = 基础成本 × (1.5 ^ 强化等级)

说明: 强化等级越高，成本越高，防止过度强化
```

#### 3. 材料稀有度

```
稀有材料获取率 < 普通材料获取率 × 0.1

说明: 稀有材料稀有，增加获取难度
```

### 经济曲线

#### 前期（1-20级）

```
金币获取: 10-50/小时
主要消耗: 技能学习、基础材料购买
强化需求: 低
```

#### 中期（21-40级）

```
金币获取: 50-200/小时
主要消耗: 装备强化、材料购买
强化需求: 中
```

#### 后期（41-60级）

```
金币获取: 200-1000/小时
主要消耗: 高级强化、稀有材料购买
强化需求: 高
```

### 平衡调整

#### 调整方式

1. **修改配置表**: 直接修改金币获取倍率、消耗倍率
2. **调整掉落率**: 修改材料掉落率
3. **调整价格**: 修改商店价格

#### 调整示例

```sql
-- 提高金币获取（平衡性调整）
UPDATE economy_config 
SET gold_multiplier = 1.2,  -- 从1.0提高到1.2
    balance_version = balance_version + 1,
    last_updated = CURRENT_TIMESTAMP
WHERE config_type = 'gold_acquisition';

-- 降低强化消耗（平衡性调整）
UPDATE economy_config 
SET enhancement_cost_multiplier = 0.9,  -- 从1.0降低到0.9
    balance_version = balance_version + 1,
    last_updated = CURRENT_TIMESTAMP
WHERE config_type = 'enhancement';
```

---

## 经济配置表

### 配置表设计

```sql
-- 经济配置表
CREATE TABLE economy_config (
    id VARCHAR(32) PRIMARY KEY,
    config_type VARCHAR(32) NOT NULL,  -- gold_acquisition/enhancement/shop
    config_key VARCHAR(64) NOT NULL,
    config_value REAL NOT NULL,
    description TEXT,
    balance_version INTEGER DEFAULT 1,
    last_updated DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 配置项

| 配置类型 | 配置键 | 默认值 | 说明 |
|---------|--------|--------|------|
| gold_acquisition | base_gold_rate | 1.0 | 基础金币获取倍率 |
| gold_acquisition | zone_multiplier | 1.0 | 区域倍率 |
| enhancement | base_cost | 100 | 基础强化消耗 |
| enhancement | cost_multiplier | 1.5 | 强化成本倍率 |
| shop | material_price_multiplier | 1.0 | 材料价格倍率 |
| shop | equipment_price_multiplier | 1.0 | 装备价格倍率 |

---

## 总结

### 设计亮点

1. **完整的经济闭环**: 获取→消耗→强化→提升→继续挑战
2. **丰富的消耗途径**: 装备强化、材料购买、技能学习等
3. **配置化平衡**: 所有经济数据可配置，方便调整
4. **合理的成本递增**: 防止过度强化，保持游戏平衡

### 后续扩展

- [ ] 经济数据分析工具
- [ ] 自动平衡调整系统
- [ ] 经济事件系统
- [ ] 经济排行榜

---

**文档版本**: v1.0  
**最后更新**: 2025年


